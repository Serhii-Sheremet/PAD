PRAGMA foreign_keys=off;

BEGIN TRANSACTION;

ALTER TABLE PROFILE RENAME TO _PROFILE_old;

CREATE TABLE IF NOT EXISTS PROFILE
(
	ID INTEGER PRIMARY KEY AUTOINCREMENT,
	PROFILENAME TEXT,
	PERSONNAME TEXT,
	PERSONSURNAME TEXT,
	DATEOFBIRTH	TEXT,
	PLACEOFBIRTHID INTEGER,
	PLACEOFLIVINGID INTEGER,
	NAKSHATRAMOONID INTEGER,
	PADAMOON INTEGER,
	NAKSHATRALAGNAID INTEGER,
	PADALAGNA INTEGER,
	NAKSHATRASUNID INTEGER,
	PADASUN INTEGER,
	NAKSHATRAVENUSID INTEGER,
	PADAVENUS INTEGER,
	NAKSHATRAJUPITERID INTEGER,
	PADAJUPITER INTEGER,
	NAKSHATRAMERCURYID INTEGER,
	PADAMERCURY INTEGER,
	NAKSHATRAMARSID INTEGER,
	PADAMARS INTEGER,
	NAKSHATRASATURNID INTEGER,
	PADASATURN INTEGER,
	NAKSHATRARAHUID INTEGER,
	PADARAHU INTEGER,
	NAKSHATRAKETUID INTEGER,
	PADAKETU INTEGER,
	CHECKED INTEGER,
	GUID TEXT,
	FOREIGN KEY (PLACEOFBIRTH) REFERENCES LOCATION (ID),
	FOREIGN KEY (PLACEOFLIVINGID) REFERENCES LOCATION (ID),
	FOREIGN KEY (NAKSHATRAMOONID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRALAGNAID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRASUNID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRAVENUSID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRAJUPITERID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRAMERCURYID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRAMARSID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRASATURNID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRARAHUID) REFERENCES NAKSHATRA (ID),
	FOREIGN KEY (NAKSHATRAKETUID) REFERENCES NAKSHATRA (ID)
);


INSERT INTO PROFILE (PROFILENAME, PERSONNAME, PERSONSURNAME, DATEOFBIRTH, PLACEOFBIRTHID, PLACEOFLIVINGID, NAKSHATRAMOONID, PADAMOON, NAKSHATRALAGNAID, PADALAGNA, 
						NAKSHATRASUNID, PADASUN, NAKSHATRAVENUSID, PADAVENUS, NAKSHATRAJUPITERID, PADAJUPITER, NAKSHATRAMERCURYID, PADAMERCURY, NAKSHATRAMARSID, PADAMARS, 
						NAKSHATRASATURNID, PADASATURN, NAKSHATRARAHUID, PADARAHU, NAKSHATRAKETUID, PADAKETU, CHECKED, GUID)
  SELECT PROFILENAME, PERSONNAME, PERSONSURNAME, DATEOFBIRTH, PLACEOFBIRTHID, PLACEOFLIVINGID, NAKSHATRAMOONID, PADAMOON, NAKSHATRALAGNAID, PADALAGNA,
			NAKSHATRASUNID, PADASUN, NAKSHATRAVENUSID, PADAVENUS, NAKSHATRAJUPITERID, PADAJUPITER, NAKSHATRAMERCURYID, PADAMERCURY, NAKSHATRAMARSID, PADAMARS, 
			NAKSHATRASATURNID, PADASATURN, NAKSHATRARAHUID, PADARAHU, NAKSHATRAKETUID, PADAKETU, CHECKED, GUID
  FROM _PROFILE_old order by ID;
  
COMMIT;

PRAGMA foreign_keys=on;